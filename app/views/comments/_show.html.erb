<div class="well">
  <h3>Comments</h3>
  <br>
  <div class="container">
    <% page.comments.each do |comment| %>
    <div class="row">
      <div class="col-sm-1">
        <div class="thumbnail">
          <img class="img-responsive user-photo" src="https://ssl.gstatic.com/accounts/ui/avatar_2x.png">
        </div><!-- /thumbnail -->
      </div><!-- /col-sm-1 -->

      <div class="col-sm-10">
        <div class="panel panel-default">
          <div class="panel-heading">
            <strong><%= link_to comment.author.name, user_path(comment.author_id) %></strong> <span class="text-muted">posted on <%= comment.time %></span>

            <% if current_user == comment.author || is_admin? %>

            <span class="pull-right">
              <%= link_to "Delete", "#{params[:id]}/delete_comment?comment_id=#{comment.id}&page_type=#{page.class}&page_id=#{page.id}", method: "delete", data: { confirm: "Are you sure?"}%></span>

            <% end %>

          </div>
          <div class="panel-body">
            <%= comment.content %>
          </div><!-- /panel-body -->
        </div><!-- /panel panel-default -->
      </div><!-- /col-sm-5 -->
    </div><!-- /row -->
    <% end %>
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <strong>New Comment</strong>
          </div>
          <div class="panel-body">
            <%= form_tag "#{params[:id]}/add_comment", method: "post" do %>
            <%= hidden_field_tag :'[page_type]', page.class %>
            <%= hidden_field_tag :'[page_id]', page.id %>
            <%= hidden_field_tag :'[comment][author_id]', current_user.id %>
            <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
            <%= text_area_tag :'[comment][content]', nil, style: "width: 100%" %><br>
            <%= submit_tag "Add Comment",  class: "btn btn-success" %>
            <% end %>
          </div><!-- /panel-body -->
        </div><!-- /panel panel-default -->
      </div><!-- /col-sm-5 -->
    </div><!-- /row -->
  </div><!-- /container -->
</div>
